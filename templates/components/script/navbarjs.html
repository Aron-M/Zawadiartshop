<script>
    document.addEventListener("DOMContentLoaded", function() {
        const dropdownToggle = document.querySelector(".dropdown-toggle");
        const dropdownMenu = document.querySelector(".dropdown-menu-slide");

        dropdownToggle.addEventListener("click", function() {
            if (dropdownMenu.style.maxHeight) {
                dropdownMenu.style.maxHeight = null;
            } else {
                dropdownMenu.style.maxHeight = dropdownMenu.scrollHeight + "px";
            }
        });

        const searchBar = document.getElementById("searchBar");
        const searchModal = new bootstrap.Modal(document.getElementById("searchModal"));

        searchBar.addEventListener("click", function() {
            searchModal.show();
        });

        // Function to close the dropdown when clicking outside
        function closeDropdown(event) {
            if (!dropdownMenu.contains(event.target) && !dropdownToggle.contains(event.target)) {
                dropdownMenu.style.maxHeight = null;
            }
        }

        
        document.addEventListener("click", closeDropdown);

        
        const dropdownItems = dropdownMenu.querySelectorAll(".custom-dropdown-item");
        dropdownItems.forEach(function(item) {
            item.addEventListener("click", function(event) {
                if (event.target.classList.contains("form-check-input")) {
                    
                    event.target.checked = !event.target.checked;
                } else {
                    
                    const checkbox = item.querySelector(".form-check-input");
                    checkbox.checked = !checkbox.checked;
                }
                event.stopPropagation();
            });
        });
    });

    document.addEventListener("DOMContentLoaded", function() {
    var alert = document.getElementById("persistent-alert");

    
    alert.classList.remove("d-none");

    setTimeout(function() {
        fadeOut(alert, 500);
    }, 3500);

    function fadeOut(element, duration) {
        var opacity = 1;
        var interval = 50;
        var step = (interval / duration); 
        var timer = setInterval(function() {
            if (opacity <= 0) {
                clearInterval(timer);
                element.style.display = "none";
            } else {
                opacity -= step;
                element.style.opacity = opacity;
            }
        }, interval);
    }
});

// Function to refresh the page
function refreshPage() {
    location.reload();
}

document.addEventListener("DOMContentLoaded", function() {
    var closeButtons = document.querySelectorAll('.btn-primary');
    
    closeButtons.forEach(function(button) {
        button.addEventListener('click', function() {
            refreshPage();
        });
    });
});

function updateAlertContent() {
    var totalProducts = 5;

    var greeting = document.getElementById("greeting");
    var productCount = document.getElementById("product-count");

    if (totalProducts === 0) {
        greeting.textContent = `Hi, ${user.username}! Welcome and happy shopping!`;
        productCount.textContent = "0";
    } else {
        greeting.textContent = `Hi, ${user.username}! You have ${totalProducts} product(s) in your cart.`;
        productCount.textContent = totalProducts;
    }
}

// Call the update function when the page loads
window.addEventListener("load", updateAlertContent);
</script>
